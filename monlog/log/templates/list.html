{% extends "base.html" %}
{% block content %}
<form class="well filters form-search">
    <input type="checkbox" name="severity" value="emergency">
    <input type="checkbox" name="severity" value="alert">
    <input type="checkbox" name="severity" value="critical">
    <input type="checkbox" name="severity" value="error">
    <input type="checkbox" name="severity" value="warning">
    <input type="checkbox" name="severity" value="notify">
    <input type="checkbox" name="severity" value="info">
    <input type="checkbox" name="severity" value="debug">
        <a href="#" id="toggle-advanced" class="btn" data-toggle="collapse" data-target="#advanced">&#9660;</a>
          <div id="severity-buttons" class="btn-group" data-toggle="buttons-checkbox">
            <a href='#' class="btn sev-emergency" data-value="emergency"><span class="dot">&nbsp;</span>Emergency</a>
            <a href='#' class="btn sev-alert" data-value="alert"><span class="dot">&nbsp;</span>Alert</a>
            <a href='#' class="btn sev-critical" data-value="critical"><span class="dot">&nbsp;</span>Critical</a>
            <a href='#' class="btn sev-error" data-value="error"><span class="dot">&nbsp;</span>Error</a>
            <a href='#' class="btn sev-warning" data-value="warning"><span class="dot">&nbsp;</span>Warning</a>
            <a href='#' class="btn sev-notify" data-value="notify"><span class="dot">&nbsp;</span>Notify</a>
            <a href='#' class="btn sev-info" data-value="info"><span class="dot">&nbsp;</span>Info</a>
            <a href='#' class="btn sev-debug" data-value="debug"><span class="dot">&nbsp;</span>Debug</a>
          </div>
          <input type="text" name="search" class="search-query" placeholder="Search...">
          <div id="advanced" class="collapse">
              <hr />
              <div class="control-group">
                  <label class="control-label" for="selectApplication">Applications</label>
                  <div class="controls">
                      <select multiple="multiple" name="applications" id="selectApplication" size="5">
                          <option value="0">MyCoolCMS</option>
                          <option value="0">Bankhemligheter</option>
                          <option value="0">Monlog</option>
                          <option value="0">Mail</option>
                          <option value="0">Webreg</option>
                          <option value="0">MyCoolCMS</option>
                          <option value="0">Bankhemligheter</option>
                          <option value="0">Monlog</option>
                          <option value="0">Mail</option>
                          <option value="0">Webreg</option>
                      </select>
                  </div>
              </div>
              <div class="control-group">
                  <label class="control-label" for="selectServer">Servers</label>
                  <div class="controls">
                      <select multiple="multiple" name="server" id="selectServer" size="5">
                          <option value="0">MyCoolCMS</option>
                          <option value="0">Bankhemligheter</option>
                          <option value="0">Monlog</option>
                          <option value="0">Mail</option>
                          <option value="0">Webreg</option>
                          <option value="0">MyCoolCMS</option>
                          <option value="0">Bankhemligheter</option>
                          <option value="0">Monlog</option>
                          <option value="0">Mail</option>
                          <option value="0">Webreg</option>
                      </select>
                  </div>
              </div>
              <div class="control-group">
                  <label class="control-label" for="selectTime">Start of time range</label>
                  <div class="controls">
                      <input type="date" value="2012-02-01" name="start">
                  </div>
                  <label class="control-label" for="selectTime">End of time range (optional)</label>
                  <div class="controls">
                      <input type="date" value="2012-02-01" name="end">
                  </div>
              </div>
              <div class="well2">
                  <div class="control-group">
                      <label class="control-label">Save this search as a label</label>
                      <div class="controls">
                          <input type="text" class="" placeholder="Enter a label name">
                          <button class="btn btn-primary">Save</button>
                      </div>
                  </div>
              </div>
          </div>
    </form>
    <table class="table">
        <thead>
            <tr>
                <th>Severity</th>
                <th>Time</th>
                <th>Application</th>
                <th>Server</th>
                <th>Message</th>
            </tr>
        </thead>
        <tbody>
            {% for msg in filterset %}
            <tr class="sev-{{ msg.pretty_severity|lower }}">
                <td><span class="label">{{ msg.pretty_severity }}</span></td>
                <td><span class="">{{ msg.datetime|date:"Y-m-d H:i:s" }}</span></td>
                <td><span class="">{{ msg.application }}</span></td>
                <td><span class="">{{ msg.server_ip }}</span></td>
                <td><span class="">{{ msg.short_desc }}</span></td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
<script src="{{ STATIC_URL }}js/api.js" type="text/javascript"></script>
<script type="text/javascript" language="javascript">
    $("#advanced").on('show', function(){
            $("#toggle-advanced").addClass("active");
            $("#toggle-advanced").html("&#9650");
    });
    $("#advanced").on('hide', function(){
        $("#toggle-advanced").removeClass("active");
        $("#toggle-advanced").html("&#9660");
        });
    $(window).load(function() {
        $("form.filters input[name='severity']").hide();
    });
    var toggleSeverity = function(button) {
        var checkbox = $("form.filters input[value='" + button.dataset['value'] + "']");
        checkbox.prop("checked", ! checkbox.prop("checked"));
        checkbox.change();
    };
    $("#severity-buttons a").bind('click', function(event){
        toggleSeverity(this);
    });
</script>
{% endblock %}
